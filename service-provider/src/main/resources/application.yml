# Spring Boot 应用配置
spring:
  # 应用名称，会显示在Nacos的服务列表中
  application:
    name: service-provider
  # Spring Cloud 相关配置
  cloud:
    # Nacos 相关配置
    nacos:
      # 服务发现/注册配置
      discovery:
        # Nacos Server 的地址
        server-addr: localhost:8848
        # 命名空间，用于环境隔离 (例如：dev, test, prod)
        namespace: public
        # 服务分组，用于逻辑隔离
        group: DEFAULT_GROUP
      # 配置中心配置
      config:
        # Nacos Server 的地址
        server-addr: localhost:8848
        # 命名空间
        namespace: public
        # 配置分组
        group: DEFAULT_GROUP
        # 指定配置文件的扩展名，应用会去Nacos读取 "service-provider.yaml" 这个配置文件
        file-extension: yaml
        # 开启配置的动态刷新功能
        refresh-enabled: true
  # 数据库配置 - Seata Demo 使用订单库
  datasource:
    url: jdbc:mysql://localhost:3306/seata_order?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: 65893ecd953a50c6
    driver-class-name: com.mysql.cj.jdbc.Driver
  # JPA 配置
  jpa:
    hibernate:
      ddl-auto: none
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.MySQLDialect

# 服务器相关配置
server:
  # 应用启动的端口号
  port: 8081

# Spring Boot Actuator 监控端点配置
management:
  endpoints:
    web:
      # 暴露所有端点 (例如 /health, /info, /metrics 等) 以供访问
      exposure:
        include: '*'
  endpoint:
    # 健康检查端点配置
    health:
      # 总是显示详细的健康信息
      show-details: always

# 应用自定义的本地默认配置
# 注意：如果Nacos配置中心存在相同的配置项，这里的配置将会被覆盖
provider:
  message: Hello from Provider - Local Config
  version: 1.0

# ==========================================
# 以下是 Seata 分布式事务 Demo 配置
# ==========================================


# Seata 分布式事务配置
seata:
  enabled: true
  application-id: ${spring.application.name}
  tx-service-group: my_tx_group
  # 注册中心：仍用 nacos 发现 Seata Server 地址
  registry:
    type：file
#    type: nacos
#    nacos:
#      server-addr: localhost:8848
#      namespace: ""
#      group: SEATA_GROUP
#      application: seata-server
  config:
    #    type: nacos
    #    nacos:
    #      server-addr: localhost:8848
    #      namespace: ""
    #      group: SEATA_GROUP
    #      data-id: seataServer.
    type: file
  service:
    vgroup-mapping:
      my_tx_group: default
    grouplist:
      default: 127.0.0.1:8091
    disable-global-transaction: false

# 日志配置
logging:
  level:
    io.seata: info
    com.timelsszhuang: debug
